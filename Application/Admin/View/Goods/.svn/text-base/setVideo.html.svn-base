<include file="Public:head"/>
<style>
    .imgnav{
        max-height: 30px;
        overflow: hidden;
        cursor: pointer;
    }
    .imgwrapper{
        display: block;
        width: 78px;
        height: 78px;
        overflow: hidden;
    }
    .imgwrapper img{
        display: block;
        width: 100%;
        padding: 0;
        margin: 0;
        border:0;
    }
    .spanpd10{
        margin:10px;
    }
    .wxtables.wxtables-sku.newtable{
        width: 40%;
        margin: 0;
    }
    .img-list li{
        width: 60px;
        height:60px;
    }
    textarea {
        resize: both;
    }
    .cst_h3 span{font-weight: normal;}
    #imgdiv img{ max-width:190px; max-height:190px; display:none; margin:5px;}
    .btnimage{width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; position:relative; text-align:center; line-height:31px;}
    .file{ position:absolute; top:0px; left:0; width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; opacity:0}
    #imgdiv2 img{ max-width:88px; max-height:88px; display:none; margin:5px;}
    #xuanze2{ width:60px; height:30px; background:white; border:1px solid #d9d9d9; }
    #xuanze2:hover{ background:#E6E6E6; }
    .huase{display:none; width:86px; height:30px; margin:5px; text-indent:5px;}

    </style>
<link rel="stylesheet" type="text/css" href="__JS__/Webuploader/webuploader.css" />
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="__JS__/Webuploader/webuploader.min.js"></script>
<script type="text/javascript" src="__JS__/Webuploader/uploade.js"></script>
<script type="text/javascript" src="__LHG__/lhgcore.min.js"></script>
<script type="text/javascript" src="__LHG__/lhgcalendar.min.js"></script>

<div class="container">
  <div class="inner clearfix"> <include file="Public:left"/> 
    <!-- end content-left -->
    
    <div class="content-right fl">
      <h1 class="content-right-title">添加视频</h1>
      <form aciton="{:U('/Admin/Goods/setVideo')}" enctype="multipart/form-data" method="post" id="add_step2" onsubmit="return toVaild()">
      <input type="hidden" name="id" value="{$cache['id']}">
        <div class="panel-single panel-single-light mgt20">
          <h3 class="cst_h3 mgb20">基本信息</h3>



             <div class="formitems">
                <label class="fi-name"><span class="colorRed">*</span>视频标题：</label>
                <div class="form-controls">
                    <input type="text" id="av_title" class="input tel" name="av_title" value="{$cache.title}" required/>
                </div>
            </div>
            <div class="formitems">
                <label class="fi-name"><span class="colorRed">*</span>视频预览图(小)：</label>
                <div class="form-controls pdt5 j-imglistPanel">
                    <div class="xuanze_showimge fl mgr10">
                        <notempty name="cache.pic"><img src="{$cache.pic}" width="150" height="100"/></notempty>
                    </div>
                    <div class="btnimage fl">选择图片
                        <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="xuanze" class="file" >
                    </div>
                    <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" />
                    </div>
                    <span class="fi-help-text fl lh30 mgl10"><b class="xuanze_percent1"></b>建议大小（宽434px高368px）</span>
                </div>
            </div>
            <div class="formitems">
                <label class="fi-name"><span class="colorRed"></span>排序：</label>
                <div class="form-controls">
                    <input type="text" class="input sort" name="sort" value="{$cache.sort}"/>
                </div>
            </div>

            <div class="formitems">
                <label class="fi-name"><span class="colorRed">*</span>视频分类：</label>
                <div class="form-controls">
                    <select name="cate" class="select">
                        <volist name="res" id="v">
                            <option <eq name="v.id" value="$cache.cate">selected</eq> value="{$v.id}">{$v.name}</option>
                        </volist>
                    </select>
                </div>
            </div>
            <!--<div class="formitems">
                <label class="fi-name"><span class="colorRed">*</span>视频标题：</label>
                <div class="form-controls">
                    <textarea class="input" style="width: 280px;height: 70px;" name="detail"/>{$cache.detail}</textarea>
                </div>
            </div>-->

           

            <div class="formitems">
                <label class="fi-name"><span class="colorRed">*</span>视频地址：</label>
                <div class="form-controls">

                    <input readonly="true" type="text"  class="input" width="300" name="video" id="video" value="{$cache.url}"/><span style="color:red;">可上传的视频格式：wmv、rmvb、3gp、mov、mp4、mkv、flv （上传大小建议：小于100M）</span>
                </div>
            </div>
           
            <input type="hidden" value='{:U("Admin/Goods/webup")}'	id='upode_parth'/>
            <div class="formitems">

                <div class="uploader-list-container">
                    <div class="queueList">
                        <div id="dndArea" class="placeholder">
                            <div class="baotuan_showimge fl mgr10">
                            </div>
                            <div id="filePicker-2"></div>

                        </div>
                    </div>
                    
                    <div class="statusBar" style="display:none;">
                        <div class="progress"> <span class="text">0%</span> <span class="percentage"></span> </div>
                        <div class="info"></div>
                        <div class="btns">
                            <div id="filePicker2"></div>
                            <div class="uploadBtn">开始上传</div>
                        </div>
                    </div>
                </div>
            </div>
        <div class="panel-single panel-single-light mgt20 txtCenter"> 
          <a href="javascript:history.back(-1);" class="btn">返回</a>
          <input type="submit"  id="submit" class="btn btn-primary" />
        </div>
      </form>
    </div>
    <!-- end content-right --> 
  </div>
</div>
<!-- end container --> 

<include file="Public:foot"/>

<script type="text/javascript" src="__JS__/jquery.js"></script> 
<!-- <script type="text/javascript" src="__JS__/uploadPreview.min.js"></script>  -->

<script type="text/javascript" src="__JS__/jquery-form.js"></script>
  <script>
        $(document).ready(function(){
            var percent1 = $('.xuanze_percent1');
            var progress1 = $('.xuanze_percent1');
            $("#xuanze").wrap("<form id='myupload1' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
            $("#xuanze").change(function(){ //选择文件
                $("#myupload1").ajaxSubmit({
                    dataType:  'json', //数据格式为json
                    beforeSend: function() { //开始上传
                        progress1.show(); //显示进度条
                        var percentVal = '0%';
                        percent1.html(percentVal);
                    },
                    uploadProgress: function(event, position, total, percentComplete) {
                        var percentVal = percentComplete + '%'; //获得进度
                        console.log(percentVal,percent1);
                        percent1.html(percentVal); //显示上传进度百分比
                    },
                    success: function(data) { //成功
                        var img = '<img src="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'" height="80" ><input type="hidden" name="logo_pic" id="pic" value="'+data[0]["savepath"].substr(1)+data[0]["savename"]+'"></input>';
                        $('.xuanze_showimge').html(img);
                        progress1.hide();
                    },
                    error:function(xhr){ //上传失败
                        //console.log(xhr.status)
                    }
                });
            });
            $('#submit').click(function(){
                var av_title = $.trim($('#av_title').val());
                if(av_title == ""){
                    alert('请输入视频标题！');return false;
                }
                var video = $('#video').val();
                if(video == ""){
                    alert('请上传视频！');return false;

                }
                var pic = $('#pic').val();
                var pic1 = '{cache.pic}';
                if(pic == undefined && pic1 == ''){
                    alert('请上传视频预览图');return false;
                }
            })
            // var pic = '/Public/Home/Images/announce_presenting.jpg';
            // var video = $('#video').val();
            // console.log(pic,video);
            // $.ajax({
            //     url:'/Admin/Goods/setVideo',
            //     type:'get',
            //     data:{video:video,picture:pic},
            //     dataType:'json',
            //     success:function(g){
            //         console.log(g);
            //     }
            // })
            
        })
                
</script>
<!--上传图片-end->


