<include file="Public:head"/>
<style>
    .imgnav{
        max-height: 30px;
        overflow: hidden;
        cursor: pointer;
    }
    .imgwrapper{
        display: block;
        width: 78px;
        height: 78px;
        overflow: hidden;
    }
    .imgwrapper img{
        display: block;
        width: 100%;
        padding: 0;
        margin: 0;
        border:0;
    }
    .spanpd10{
        margin:10px;
    }
    .wxtables.wxtables-sku.newtable{
        width: 40%;
        margin: 0;
    }
    .img-list li{
        width: 60px;
        height:60px;
    }
    textarea {
        resize: both;
    }
    .cst_h3 span{font-weight: normal;}
    #imgdiv img{ max-width:190px; max-height:190px; display:none; margin:5px;}
    .btnimage{width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; position:relative; text-align:center; line-height:31px;}
    .file{ position:absolute; top:0px; left:0; width:80px; height:30px; background:white; border:1px solid #d9d9d9;cursor:pointer; opacity:0}
    #imgdiv2 img{ max-width:88px; max-height:88px; display:none; margin:5px;}
    #xuanze2{ width:60px; height:30px; background:white; border:1px solid #d9d9d9; }
    #xuanze2:hover{ background:#E6E6E6; }
    .huase{display:none; width:86px; height:30px; margin:5px; text-indent:5px;}

</style>
<script type="text/javascript" src="__LHG__/lhgcore.min.js"></script>
<script type="text/javascript" src="__LHG__/lhgcalendar.min.js"></script>
<script type="text/javascript" src="__JS__/datepicker/WdatePicker.js"></script>
<div class="container">
    <div class="inner clearfix"> <include file="Public:left"/> 
        <!-- end content-left -->

        <div class="content-right fl">
            <h1 class="content-right-title">编辑产品</h1>
            <form aciton="{:U('/Admin/Index/indexConfig')}" enctype="multipart/form-data" method="post" id="add_step2" onsubmit="return toVaild()">
                <input type="hidden" name="id" value="{$cache['id']}">
                <div class="panel-single panel-single-light mgt20">
                    <h3 class="cst_h3 mgb20">基本信息</h3>





                    <div class="formitems">
                        <label class="fi-name">商品logo图片(小)：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="xuanze_showimge fl mgr10">
                                <img src="{$cache['top_pic']}" width="300"> 
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="xuanze" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="xuanze_percent">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽292高68）</span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name">商品logo图片(小)：</label>
                        <div class="form-controls pdt5 j-imglistPanel">
                            <div class="xuanze_showimge1 fl mgr10">
                                <img src="{$cache['buttom_pic']}" width="70%"> 
                            </div>
                            <div class="btnimage fl">选择图片
                                <input type="file"  accept="image/jpg,image/jpeg,image/png" name="serial" id="xuanze1" class="file" >
                            </div>
                            <div class="xuanze_progress fl mgr15" style="display:none"><img src="__IMAGES__/loadings.gif" width="30" /><span class="xuanze_percent1">80%</span></div>
                            <span class="fi-help-text fl lh30 mgl10">建议大小（宽107高97）</span>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>联系方式：</label>
                        <div class="form-controls">
                            <input type="text" class="input tel" name="tel" value="{$cache.tel}"/>
                        </div>
                    </div>
                    <div class="formitems">
                        <label class="fi-name"><span class="colorRed">*</span>地址：</label>
                        <div class="form-controls">
                            <input type="text" class="input address" name="address" value="{$cache.address}"/>
                        </div>
                    </div>
                    <!-- end 详情及其它 -->
                    <div class="panel-single panel-single-light mgt20 txtCenter"> 
                        <a href="{:U('Admin/Goods/goodsList')}" class="btn">取消</a>
                        <input type="submit" id="submit" class="btn btn-primary" />
                    </div>
            </form>
        </div>
        <!-- end content-right --> 
    </div>
</div>
<!-- end container --> 

<include file="Public:foot"/>

<script type="text/javascript" src="__JS__/jquery.js"></script> 
<script type="text/javascript" src="__JS__/uploadPreview.min.js"></script> 

<script type="text/javascript" src="__JS__/jquery-form.js"></script>
<script type="text/javascript">
          $(function () {
              var percent = $('.xuanze_percent');
              var progress = $('.xuanze_percent');
              $("#xuanze").wrap("<form id='myupload2' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
              $("#xuanze").change(function () { //选择文件 
                  $("#myupload2").ajaxSubmit({
                      dataType: 'json', //数据格式为json 
                      beforeSend: function () { //开始上传 
                          progress.show(); //显示进度条
                          var percentVal = '0%';
                          percent.html(percentVal);
                      },
                      uploadProgress: function (event, position, total, percentComplete) {
                          var percentVal = percentComplete + '%'; //获得进度 
                          percent.html(percentVal); //显示上传进度百分比 
                      },
                      success: function (data) { //成功 
                          var img = '<img src="' + data[0]["savepath"].substr(1) + data[0]["savename"] + '" width="300" ><input type="hidden" name="top_pic" id="pic1" value="' + data[0]["savepath"].substr(1) + data[0]["savename"] + '"></input>';
                          $('.xuanze_showimge').html(img);
                          progress.hide();
                      },
                      error: function (xhr) { //上传失败 
                          //console.log(xhr.status)
                      }
                  });
              });
          });
          $(function () {
              var percent = $('.xuanze_percent1');
              var progress = $('.xuanze_percent1');
              $("#xuanze1").wrap("<form id='myupload1' action='{:U('/Admin/Index/addImage')}' method='post' enctype='multipart/form-data'></form>");
              $("#xuanze1").change(function () { //选择文件 
                  $("#myupload1").ajaxSubmit({
                      dataType: 'json', //数据格式为json 
                      beforeSend: function () { //开始上传 
                          progress.show(); //显示进度条
                          var percentVal = '0%';
                          percent.html(percentVal);
                      },
                      uploadProgress: function (event, position, total, percentComplete) {
                          var percentVal = percentComplete + '%'; //获得进度 
                          percent.html(percentVal); //显示上传进度百分比 
                      },
                      success: function (data) { //成功 
                          var img = '<img src="' + data[0]["savepath"].substr(1) + data[0]["savename"] + '" width="70%" ><input type="hidden" name="buttom_pic" id="pic" value="' + data[0]["savepath"].substr(1) + data[0]["savename"] + '"></input>';
                          $('.xuanze_showimge1').html(img);
                          progress.hide();
                      },
                      error: function (xhr) { //上传失败 
                          //console.log(xhr.status)
                      }
                  });
              });
          });

          function toVaild() {
              var tel = $('#tel').val();
              var reg = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
              if (!reg.test(tel)){
                  alert('请输入有效的手机号码！');
                  return false;
              }
          }
// $("#submit").click(function (){
//     var post = {};
//     post.url         = $.trim($(".url").val());
//     post.logo        = $.trim($("#pic").val());
//     post.title       = $.trim($(".title").val());
//     post.keywords    = $.trim($(".keywords").val());
//     post.description = $.trim($(".description").val());
//     post.copyright   = $.trim($(".copyright").val());
//     post.tel   = $.trim($(".tel").val());
//     post.address   = $.trim($(".address").val());
          // if(!post.url){
          //     alert("网页网址不能为空！");return false;
          // }
          // if(!post.url.match(/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/)){
          //     alert("网页网址格式错误！");return false;
          // }
          // if(!post.logo && !"{$cache['logo']}"){
          //     alert("请上传网站logo");return false;
          // }
          // if(!post.title){
          //     alert("SEO标题不能为空！");return false;
          // }
          // if(!post.keywords){
          //     alert("SEO关键字不能为空！");return false;
          // }
          // if(!post.description){
          //     alert("SEO描述不能为空！");return false;
          // }
          // if(!post.copyright){
          //     alert("版权不能为空！");return false;
          // }
          // $.post("{:U('Admin/Index/seoChange')}", post, function (data){
          //     alert(data.info);
          //     if(data.status == 1){
          //         window.location.reload();
          //     }
          // }, "json")
          // return false;
// })
</script>
<!--上传图片-end->


